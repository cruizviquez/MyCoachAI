// ...existing code from your main Summary (copy from previous working version)